<!DOCTYPE html>
<html>
<head>
    <title>test</title>
    <script type="text/javascript" src="assets/js/log4javascript.js"></script>
    <script type="text/javascript">
        window.onerror = function (message, url, linenumber) {
            var xmlhttp;
            if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            }
            else {// code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.open("POST", "http://jslogger.localhost.com/logger/log", true);
            xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
//            xmlhttp.send("message=" + message + "&url=" + url + "&lineNumber=" + linenumber);
            xmlhttp.send("message=" + message + url + linenumber);
// alert("JavaScript error: " + message + " on line " + linenumber + " for " + url);
        }
        function logError(exception) {
            var xmlhttp;
            if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            }
            else {// code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    document.getElementById("myDiv").innerHTML = xmlhttp.responseText;
                }
            }


            xmlhttp.open("POST", "http://jslogger.localhost.com/logger/log", true);
            xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xmlhttp.send("exception=" + exception);
        }
    </script>


    <script>
        try {
            throw new Error("testing");

        } catch (err) {
            logError(err.stack);
        } finally {
            alert("Logging error");
        }


        var e = new Error('dummy');
        var stack = e.stack.replace(/^[^\(]+?[\n$]/gm, '')
                .replace(/^\s+at\s+/gm, '')
                .replace(/^Object.<anonymous>\s*\(/gm, '{anonymous}()@')
                .split('\n');

        logError(stack);
    </script>
</head>
<body>

</body>
</html>